#!/bin/bash
. $(dirname $0)/../lib/functions

if [ "$#" -ne 2 ]; then
cat >&2 <<EOT
Usage:
$0 <test name> <configuration name>
  -- create a directory for a run of the named test and configuration
EOT
  exit 0
fi
test=$1
config=$2
bin=$(dirname $0)
hardware=$(${bin}/get-hardware-id)
time=$(date +%s)

results=${bin}/../results
mkdir -p ${results}
run=${results}/${hardware}/${test}/${config}/${time}
mkdir -p ${run}
echo $commit > ${run}/commit
echo $version > ${run}/version
echo $time > ${run}/time
system_profiler SPHardwareDataType > ${run}/SPHardwareDataType
system_profiler SPSoftwareDataType > ${run}/SPSoftwareDataType
echo $(pwd)/${run}
