---
title: "How do I change where my images are stored in DTR 2.x?"
id: 1277
draftstate: inactive
deleted: false
source: https://success.docker.com/@api/deki/pages/1277/contents
tags:
- tag: "article:howto"
- tag: "component:dtr"
- tag: "product:datacenter"
- tag: "stage:reviewed"
- tag: "testedon:dtr-2.0.0"
- tag: "testedon:dtr-2.1.0"
- tag: "testedon:dtr-2.2.1"
---
{% raw %}
<div class="mt-section" id="section_1" mt-section-origin="KBase/How_do_I_change_where_my_images_are_stored_in_DTR_2.x?">
 <span id="DTR_2.1.x_and_newer">
 </span>
 <h3 id="2-0">
  DTR 2.1.x and newer
 </h3>
 <p>
  Docker Trusted Registry stores its data in a volume that corresponds with its replica id. For example, the
  <code>
   dtr-registry-000000000000
  </code>
  volume is where the DTR with replica id
  <code>
   000000000000
  </code>
  stores its registry data when using the filesystem backend.
 </p>
 <p>
  To store your images in an NFS directory, specify the NFS URL at install time or switch to an NFS location after install with the
  <code>
   reconfigure
  </code>
  subcommand.
 </p>
 <p>
  Details on this procedure are found in the docs:
 </p>
 <ul>
  <li>
   For DTR 2.2.x, see
   <a class="link-https" href="https://docs.docker.com/datacenter/dtr/2.2/guides/admin/configure/external-storage/nfs/" rel="freeklink" title="https://docs.docker.com/datacenter/dtr/2.2/guides/admin/configure/external-storage/nfs/">
    https://docs.docker.com/datacenter/d...l-storage/nfs/
   </a>
   .
  </li>
  <li>
   For DTR 2.1.x see
   <a class="link-https" href="https://docs.docker.com/datacenter/dtr/2.1/guides/configure/use-nfs/" rel="freeklink" title="https://docs.docker.com/datacenter/dtr/2.1/guides/configure/use-nfs/">
    https://docs.docker.com/datacenter/d...igure/use-nfs/
   </a>
   .
  </li>
 </ul>
 <p>
  To switch to a non-NFS storage location, you can specify the filesystem path of a manually-created volume name at install or reconfigure time. For example, to store the registry data at the
  <code>
   /opt/registry/data
  </code>
  location on the host filesystem, run the
  <code>
   install
  </code>
  command including the
  <code>
   --dtr-storage-volume
  </code>
  argument:
 </p>
 <pre>
docker run --rm -it docker/dtr install --dtr-storage-volume <span class="replaceabletext">/opt/registry/data</span> ...</pre>
 <p>
  The
  <code>
   dtr-registry-
   <span class="replaceabletext">
    xxxxxxxxxxxx
   </span>
  </code>
  container will end up with
  <code>
   /opt/registry/data
  </code>
  as a BIND mount instead of using the
  <code>
   dtr-registry-
   <span class="replaceabletext">
    xxxxxxxxxxxx
   </span>
  </code>
  volume that the installer would otherwise create.
 </p>
 <p>
  It is also possible to specify a volume instead of a host directory. For example, to specify a volume called
  <code>
   registrydata
  </code>
  on a DTR node, use the
  <code>
   --dtr-storage-volume
  </code>
  argument:
 </p>
 <pre>
docker run --rm -it docker/dtr install --dtr-storage-volume <span class="replaceabletext">registrydata</span> ...</pre>
 <p>
  The
  <code>
   --dtr-storage-volume
  </code>
  option is also available when running docker/dtr reconfigure, so you can change the location that DTR uses after installation.
 </p>
</div>
<div class="mt-section" id="section_2" mt-section-origin="KBase/How_do_I_change_where_my_images_are_stored_in_DTR_2.x?">
 <span id="DTR_2.0.x">
 </span>
 <h3 id="2-1">
  DTR 2.0.x
 </h3>
 <p>
  Docker Trusted Registry (DTR) shows a path such as
  <code>
   /var/lib/docker/volumes/dtr-registry-
   <span class="replaceabletext">
    000000000000
   </span>
   /_data
  </code>
  in what appears to be an editable text field, but it is grayed out. This text box is informational only. You can mount a filesystem at this location to store images in a different location.
 </p>
 <p>
  To store your files at a different location:
 </p>
 <ol>
  <li>
   Use SSH to connect to the node running the DTR replica.
  </li>
  <li>
   Run the following command to find a volume called
   <code>
    dtr-registry-
    <span class="replaceabletext">
     $REPLICA_ID
    </span>
   </code>
   , where
   <span class="replaceabletext">
    $REPLICA_ID
   </span>
   corresponds to your twelve digit random hexadecimal DTR replica ID:
   <pre>
docker volume ls</pre>
  </li>
  <li>
   Verify the proper location:
   <pre>
docker inspect dtr-registry-$REPLICA_ID</pre>
   You should see a mount point listed. This should correspond with the grayed out value in the GUI.
  </li>
  <li>
   Mount your desired location as this location.
   <p>
    For example, you can use NFS to mount a different filesystem to this location.
   </p>
   <pre>
mount -t nfs server:/path/on/server /var/lib/docker/volumes/dtr-registry-$REPLICA_ID/_data
</pre>
   <p>
    To use another location, use a BIND mount. For example:
   </p>
   <pre>
mount -o bind /path/on/system /var/lib/docker/volumes/dtr-registry-$REPLICA_ID/_data
</pre>
  </li>
  <li>
   <p>
    Once done, restart the Docker service on your system. Once it comes back up, your DTR images should now be served from this new location.
   </p>
  </li>
  <li>
   <p>
    Make sure to add the mount point into your
    <code>
     /etc/fstab
    </code>
    so that they are still available on next boot.
   </p>
  </li>
 </ol>
</div>
{% endraw %}
